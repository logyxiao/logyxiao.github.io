<!DOCTYPE html><html lang="zh-cn" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="sitemap" href="/sitemap-index.xml"><!-- 防止样式闪烁的优化 --><style>
	/* 防止FOUC的最小CSS */
	html { visibility: hidden; opacity: 0; }
	html.loaded { visibility: visible; opacity: 1; transition: opacity 0.3s ease; }
	/* 基础字体和背景 */
	body { 
		font-family: 'Roboto', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
		background-color: #ffffff;
		color: #171717;
		line-height: 1.6;
	}
</style><!-- CSS预加载 --><link rel="preload" href="/_astro/global.css" as="style"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="Logyxiao's Blog" href="https://logyxiao.cc/rss.xml"><meta name="generator" content="Astro v5.13.5"><!-- Canonical URL --><link rel="canonical" href="https://logyxiao.cc/blog/frontend/canvas/fireworks/"><!-- Primary Meta Tags --><title>「Canvas 动画 」- 烟花</title><meta name="title" content="「Canvas 动画 」- 烟花"><meta name="description" content="在开发之前,我们要了解一下烟花从上升到爆炸的过程: 1. 设定烟花初始位置,爆炸位置,朝终点飞行 2. 受重力作用, 上升速度逐渐减慢 3. 烟花到达爆炸位置,爆炸散发出火花,烟花圆点消失 4. 火花以爆炸位置为圆心,向四周扩散,并且高度缓慢下降 5. 经过短暂时间,火花消失"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://logyxiao.cc/blog/frontend/canvas/fireworks/"><meta property="og:title" content="「Canvas 动画 」- 烟花"><meta property="og:description" content="在开发之前,我们要了解一下烟花从上升到爆炸的过程: 1. 设定烟花初始位置,爆炸位置,朝终点飞行 2. 受重力作用, 上升速度逐渐减慢 3. 烟花到达爆炸位置,爆炸散发出火花,烟花圆点消失 4. 火花以爆炸位置为圆心,向四周扩散,并且高度缓慢下降 5. 经过短暂时间,火花消失"><meta property="og:image" content="https://logyxiao.cc/_astro/loading.MEf-iKv8.gif"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://logyxiao.cc/blog/frontend/canvas/fireworks/"><meta property="twitter:title" content="「Canvas 动画 」- 烟花"><meta property="twitter:description" content="在开发之前,我们要了解一下烟花从上升到爆炸的过程: 1. 设定烟花初始位置,爆炸位置,朝终点飞行 2. 受重力作用, 上升速度逐渐减慢 3. 烟花到达爆炸位置,爆炸散发出火花,烟花圆点消失 4. 火花以爆炸位置为圆心,向四周扩散,并且高度缓慢下降 5. 经过短暂时间,火花消失"><meta property="twitter:image" content="https://logyxiao.cc/_astro/loading.MEf-iKv8.gif"><!-- 防止FOUC的脚本 --><script>
	// 页面加载完成后显示内容
	document.addEventListener('DOMContentLoaded', () => {
		document.documentElement.classList.add('loaded');
	});
	
	// 如果DOMContentLoaded已经触发（例如缓存页面）
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', () => {
			document.documentElement.classList.add('loaded');
		});
	} else {
		document.documentElement.classList.add('loaded');
	}
</script><link rel="stylesheet" href="/_astro/WalineComment.BwbXQ6L5.css">
<link rel="stylesheet" href="/_astro/about.YKj_kqpF.css">
<link rel="stylesheet" href="/_astro/about.BfUymB-z.css"></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>Logyxiao&#39;s Blog</a></h2> <!-- 桌面端导航 --> <div class="desktop-nav hidden md:flex" data-astro-cid-3ef6ksr2> <a href="/zh-cn/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> 首页 </a>  <a href="/zh-cn/blog" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> 博客 </a>  <a href="/zh-cn/movies" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> 影视 </a>  <a href="/zh-cn/about" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> 关于 </a>  <!-- 桌面端语言切换 --> <div class="language-dropdown" data-astro-cid-3ef6ksr2> <button class="dropdown-trigger" id="language-trigger" data-astro-cid-3ef6ksr2> <span data-astro-cid-3ef6ksr2>语言</span> <svg class="dropdown-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" data-astro-cid-3ef6ksr2></path> </svg> </button> <div class="dropdown-menu" id="language-menu" data-astro-cid-3ef6ksr2> <a href="/zh-cn/blog/frontend/canvas/fireworks/" class="dropdown-item active" data-lang="zh-cn" data-astro-cid-3ef6ksr2> <span class="lang-name" data-astro-cid-3ef6ksr2>简体中文</span> <svg class="check-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-astro-cid-3ef6ksr2></path> </svg> </a><a href="/en/blog/frontend/canvas/fireworks/" class="dropdown-item " data-lang="en" data-astro-cid-3ef6ksr2> <span class="lang-name" data-astro-cid-3ef6ksr2>English</span>  </a> </div> </div> </div> <!-- 移动端汉堡菜单 --> <div class="mobile-nav md:hidden flex px-3 flex items-center" data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>Logyxiao&#39;s Blog</a></h2> <button class="hamburger-menu" id="mobile-menu-trigger" aria-label="打开菜单" data-astro-cid-3ef6ksr2> <span class="hamburger-line" data-astro-cid-3ef6ksr2></span> <span class="hamburger-line" data-astro-cid-3ef6ksr2></span> <span class="hamburger-line" data-astro-cid-3ef6ksr2></span> </button> </div> </nav> </header> <!-- 移动端菜单面板 - 移到 header 外部 --> <div class="mobile-menu-overlay" id="mobile-menu-overlay" data-astro-cid-3ef6ksr2></div> <div class="mobile-menu-panel" id="mobile-menu-panel" data-astro-cid-3ef6ksr2> <div class="mobile-menu-header " data-astro-cid-3ef6ksr2> <button class="close-button" id="mobile-menu-close" aria-label="关闭菜单" data-astro-cid-3ef6ksr2> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-astro-cid-3ef6ksr2></path> </svg> </button> </div> <div class="mobile-menu-content" data-astro-cid-3ef6ksr2> <nav class="mobile-nav-links" data-astro-cid-3ef6ksr2> <a href="/zh-cn/" class="mobile-nav-link" data-astro-cid-3ef6ksr2> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" data-astro-cid-3ef6ksr2></path> </svg> 首页 </a> <a href="/zh-cn/blog" class="mobile-nav-link" data-astro-cid-3ef6ksr2> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" data-astro-cid-3ef6ksr2></path> </svg> 博客 </a> <a href="/zh-cn/movies" class="mobile-nav-link" data-astro-cid-3ef6ksr2> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-astro-cid-3ef6ksr2></path> </svg> 影视 </a> <a href="/zh-cn/about" class="mobile-nav-link" data-astro-cid-3ef6ksr2> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" data-astro-cid-3ef6ksr2></path> </svg> 关于 </a> </nav> <!-- 移动端语言切换 --> <div class="mobile-language-section" data-astro-cid-3ef6ksr2> <h4 data-astro-cid-3ef6ksr2>语言</h4> <div class="mobile-language-options" data-astro-cid-3ef6ksr2> <a href="/zh-cn/blog/frontend/canvas/fireworks/" class="mobile-language-item active" data-lang="zh-cn" data-astro-cid-3ef6ksr2> <span class="lang-name" data-astro-cid-3ef6ksr2>简体中文</span> <svg class="check-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-astro-cid-3ef6ksr2></path> </svg> </a><a href="/en/blog/frontend/canvas/fireworks/" class="mobile-language-item " data-lang="en" data-astro-cid-3ef6ksr2> <span class="lang-name" data-astro-cid-3ef6ksr2>English</span>  </a> </div> </div> </div> </div>  <script type="module">document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("mobile-menu-trigger"),l=document.getElementById("mobile-menu-overlay"),t=document.getElementById("mobile-menu-panel"),r=document.getElementById("mobile-menu-close"),s=document.getElementById("language-trigger"),o=document.getElementById("language-menu");if(a&&l&&t&&r){const i=()=>{a.classList.add("active"),l.classList.add("show"),t.classList.add("show"),document.body.style.overflow="hidden"},n=()=>{a.classList.remove("active"),l.classList.remove("show"),t.classList.remove("show"),document.body.style.overflow=""};a.addEventListener("click",i),r.addEventListener("click",n),l.addEventListener("click",n),t.querySelectorAll(".mobile-nav-link, .mobile-language-item").forEach(e=>{e.addEventListener("click",n)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&t.classList.contains("show")&&n()})}if(s&&o){const i=()=>{o.classList.toggle("show");const e=s.querySelector(".dropdown-arrow");e&&(e.style.transform=o.classList.contains("show")?"rotate(180deg)":"")},n=()=>{o.classList.remove("show");const e=s.querySelector(".dropdown-arrow");e&&(e.style.transform="")};s.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),i()}),document.addEventListener("click",e=>{const c=s.closest(".language-dropdown");c&&!c.contains(e.target)&&n()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&o.classList.contains("show")&&n()}),o.querySelectorAll(".dropdown-item").forEach(e=>{e.addEventListener("click",c=>{const m=e.getAttribute("href");m&&(window.location.href=m)})})}let d;window.addEventListener("resize",()=>{clearTimeout(d),d=setTimeout(()=>{if(window.innerWidth>=768&&t&&t.classList.contains("show")&&(a.classList.remove("active"),l.classList.remove("show"),t.classList.remove("show"),document.body.style.overflow=""),window.innerWidth<768&&o&&o.classList.contains("show")){o.classList.remove("show");const i=s.querySelector(".dropdown-arrow");i&&(i.style.transform="")}},150)})});</script> <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo>  </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <h1 data-astro-cid-bvzihdzo>「Canvas 动画 」- 烟花</h1> <div class="date" data-astro-cid-bvzihdzo> 2020年8月13日 </div> </div> </div> <div class="blog-content-toc-wrapper" data-astro-cid-bvzihdzo> <div class="blog-content-main prose blog-content-centered" data-astro-cid-bvzihdzo>  <h1 id="canvas-动画---烟花"><a class="heading-link" aria-label="链接到此标题" href="#canvas-动画---烟花">「Canvas 动画 」- 烟花</a></h1>
<p><img src="https://i.loli.net/2021/10/22/T4bZcMY9BweoJVq.gif" alt="">
<a href="https://logyxiao.github.io/canvas/fireworks" class="external-link" rel="noopener noreferrer" target="_blank">在线demo地址</a></p>
<h2 id="前言"><a class="heading-link" aria-label="链接到此标题" href="#前言">前言</a></h2>
<p>在开发之前,我们要了解一下烟花从上升到爆炸的过程:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>1. 设定烟花初始位置,爆炸位置,朝终点飞行</span></span>
<span class="line"><span>2. 受重力作用, 上升速度逐渐减慢</span></span>
<span class="line"><span>3. 烟花到达爆炸位置,爆炸散发出火花,烟花圆点消失</span></span>
<span class="line"><span>4. 火花以爆炸位置为圆心,向四周扩散,并且高度缓慢下降</span></span>
<span class="line"><span>5. 经过短暂时间,火花消失</span></span></code></pre>
<p>由此,我们可以先列出主要对象和属性:</p>
<ul>
<li>烟花
<ul>
<li>实时坐标: <code>(x, y)</code></li>
<li>颜色:<code>color</code></li>
<li>半径:<code>radius</code></li>
<li>携带爆炸火花:<code>booms</code></li>
<li>发生爆炸坐标:<code>boomPoint</code></li>
<li>是否已经爆炸:<code>dead</code></li>
</ul>
</li>
<li>火花
<ul>
<li>实时坐标: <code>(x, y)</code></li>
<li>爆炸圆心:<code>(centerX, centerY)</code></li>
<li>飞行目标坐标:<code>dieX, dieY</code></li>
<li>颜色:<code>color</code></li>
<li>半径:<code>radius</code></li>
<li>是否已经消失:<code>dead</code></li>
</ul>
</li>
</ul>
<h2 id="基本框架"><a class="heading-link" aria-label="链接到此标题" href="#基本框架">基本框架</a></h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> canvas</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">querySelector</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"#canvas"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> ctx</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> canvas.</span><span style="color:#B392F0">getContext</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"2d"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> _W</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> canvas.width </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> window.innerWidth</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> _H</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> canvas.height </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> window.innerHeight</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> FireWork</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  constructor</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">color</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">boomPoint</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> _W</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> radius</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.color </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> color</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.booms </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.boomPoint </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> boomPoint</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Spark</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  constructor</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">centerX</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">centerY</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">color</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">dieX</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">dieY</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dieX </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dieX;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dieY;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerX;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerY;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.centerX </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerX;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.centerY </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerY;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> radius;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.color </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> color;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"><span style="color:#6A737D">// 动画函数,实时清空画布并重新绘制</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#B392F0"> animation</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#E1E4E8">  window.</span><span style="color:#B392F0">requestAnimationFrame</span><span style="color:#E1E4E8">(animation);</span></span>
<span class="line"><span style="color:#E1E4E8">  ctx.</span><span style="color:#B392F0">clearRect</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, canvas.width, canvas.height);</span></span>
<span class="line"><span style="color:#6A737D">  // 绘制...</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">animation</span><span style="color:#E1E4E8">()</span></span></code></pre>
<h2 id="烟花飞行"><a class="heading-link" aria-label="链接到此标题" href="#烟花飞行">烟花飞行</a></h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#B392F0"> random</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">min</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">max</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> (max </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> min) </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> min</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> FireWork</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  constructor</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">color</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">boomPoint</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> _W</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> radius</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.color </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> color</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.booms </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.boomPoint </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> boomPoint</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.boomArea </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">150</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D">// 距离范围</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  move</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#6A737D">    // 与爆炸位置的距离,逐渐变小</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomPoint.x </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomPoint.y </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y</span></span>
<span class="line"><span style="color:#6A737D">    // 跟随距离改变上升速度,逐渐变慢</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.01</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.01</span></span>
<span class="line"><span style="color:#6A737D">    // 后期烟花移动速度过慢,故给一个距离范围,进入范围便爆炸</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dx) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomArea </span><span style="color:#F97583">&#x26;&#x26;</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dy) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomArea) {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  draw</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">save</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">beginPath</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">arc</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.color</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">fill</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">restore</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#6A737D">	// 模拟烟花尾随特效</span></span>
<span class="line"><span style="color:#B392F0">  drawTail</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">save</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "rgba(186,186,86,0.3)"</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">beginPath</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">arc</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> 4</span><span style="color:#E1E4E8">), </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">fill</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">restore</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  update</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.dead) {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">move</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">draw</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">drawTail</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583"> const</span><span style="color:#79B8FF"> o</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> FireWork</span><span style="color:#E1E4E8">(_W </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"#FFF"</span><span style="color:#E1E4E8">, {</span></span>
<span class="line"><span style="color:#E1E4E8">        x: _W </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        y: </span><span style="color:#79B8FF">10</span></span>
<span class="line"><span style="color:#E1E4E8">    })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583"> const</span><span style="color:#B392F0"> animation</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#E1E4E8">   window.</span><span style="color:#B392F0">requestAnimationFrame</span><span style="color:#E1E4E8">(animation);</span></span>
<span class="line"><span style="color:#6A737D">   // 使用 透明度0.1填充画布,实现烟花拖拽特效</span></span>
<span class="line"><span style="color:#E1E4E8">   ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "rgba(0, 0, 0, 0.1)"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">   ctx.</span><span style="color:#B392F0">fillRect</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, canvas.width, canvas.height);</span></span>
<span class="line"><span style="color:#E1E4E8">   o.</span><span style="color:#B392F0">update</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">animation</span><span style="color:#E1E4E8">()</span></span></code></pre>
<h2 id="火花飞行"><a class="heading-link" aria-label="链接到此标题" href="#火花飞行">火花飞行</a></h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Spark</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  constructor</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">centerX</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">centerY</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">color</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">dieX</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">dieY</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dieX </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dieX;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dieY;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerX;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerY;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.centerX </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerX;</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.centerY </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerY;</span></span>
<span class="line"><span style="color:#6A737D">    // 火花大小差异化</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(radius, radius </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.color </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> color;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#B392F0">  draw</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">save</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">beginPath</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">arc</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.color;</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">fill</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">restore</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#B392F0">  move</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#6A737D">    // 模拟重力下降</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 10</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieX </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y</span></span>
<span class="line"><span style="color:#6A737D">    // 如果距离小于 0.1 则坐标直接等于消失坐标</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dx) </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0.1</span><span style="color:#F97583"> ?</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieX </span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dy) </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0.1</span><span style="color:#F97583"> ?</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#6A737D">    // x 达到消失坐标,则消失</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (dx </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> &#x26;&#x26;</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dy) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> 80</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#B392F0">  update</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.dead) {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">move</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">draw</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="烟花爆炸"><a class="heading-link" aria-label="链接到此标题" href="#烟花爆炸">烟花爆炸</a></h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> FireWork</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">	// ...省略</span></span>
<span class="line"><span style="color:#B392F0">  move</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomPoint.x </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomPoint.y </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.01</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.01</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dx) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomArea </span><span style="color:#F97583">&#x26;&#x26;</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dy) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomArea) {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span></span>
<span class="line"><span style="color:#6A737D">      // 烟花到达爆炸点,初始化火花对象</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">initBoom</span><span style="color:#E1E4E8">() </span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  initBoom</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#6A737D">    // 随机爆炸数量</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> num </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">200</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">let</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">; i </span><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8"> num; i</span><span style="color:#F97583">++</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D">      // 随机爆炸角度</span></span>
<span class="line"><span style="color:#F97583">      let</span><span style="color:#E1E4E8"> tan </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">, Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">      let</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">400</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">cos</span><span style="color:#E1E4E8">(tan) </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x;</span></span>
<span class="line"><span style="color:#F97583">      let</span><span style="color:#E1E4E8"> y </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">400</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">sin</span><span style="color:#E1E4E8">(tan) </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y;</span></span>
<span class="line"><span style="color:#F97583">      let</span><span style="color:#E1E4E8"> boom </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> Spark</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">), </span><span style="color:#B392F0">randomColor</span><span style="color:#E1E4E8">(), x, y);</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.booms.</span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(boom);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#6A737D">	// 火花爆炸函数</span></span>
<span class="line"><span style="color:#B392F0">  boomAction</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">let</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">; i </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.booms.</span><span style="color:#79B8FF">length</span><span style="color:#E1E4E8">; i</span><span style="color:#F97583">++</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">      if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.booms[i].dead) {</span></span>
<span class="line"><span style="color:#79B8FF">        this</span><span style="color:#E1E4E8">.booms[i].</span><span style="color:#B392F0">update</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">      }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  update</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.dead) {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">move</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">draw</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">drawTail</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">boomAction</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="最终代码"><a class="heading-link" aria-label="链接到此标题" href="#最终代码">最终代码</a></h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#E1E4E8">&#x3C;!</span><span style="color:#85E89D">DOCTYPE</span><span style="color:#B392F0"> html</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">html</span><span style="color:#B392F0"> lang</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"en"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">head</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">meta</span><span style="color:#B392F0"> charset</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"UTF-8"</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">meta</span><span style="color:#B392F0"> name</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"viewport"</span><span style="color:#B392F0"> content</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"width=device-width, initial-scale=1.0"</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">title</span><span style="color:#E1E4E8">>烟花&#x3C;/</span><span style="color:#85E89D">title</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">style</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#85E89D">        body</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">            margin</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">            padding</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">            overflow</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">hidden</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/</span><span style="color:#85E89D">style</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">head</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">body</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">canvas</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">'canvas'</span><span style="color:#E1E4E8">>&#x3C;/</span><span style="color:#85E89D">canvas</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">body</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#B392F0"> random</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">min</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">max</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> (max </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> min) </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> min</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#B392F0"> randomColor</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#F97583">        let</span><span style="color:#E1E4E8"> colors </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#9ECBFF">            "#f44336"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#e91e63"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#9c27b0"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#673ab7"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#3f51b5"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#2196f3"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#03a9f4"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#00bcd4"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#009688"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#4CAF50"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#8BC34A"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#CDDC39"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#FFEB3B"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#FFC107"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#FF9800"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            "#FF5722"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        ];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        let</span><span style="color:#E1E4E8"> num </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">floor</span><span style="color:#E1E4E8">(Math.</span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> colors.</span><span style="color:#79B8FF">length</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> colors[num]</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> canvas</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">querySelector</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"#canvas"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> ctx</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> canvas.</span><span style="color:#B392F0">getContext</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"2d"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> _W</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> canvas.width </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> window.innerWidth</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> _H</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> canvas.height </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> window.innerHeight</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    class</span><span style="color:#B392F0"> FireWork</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        constructor</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">color</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">boomPoint</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> _W</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> radius</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.color </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> color</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.booms </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.boomPoint </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> boomPoint</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.boomArea </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">150</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.sparkDead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">        move</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#6A737D">            // 与爆炸位置的距离,逐渐变小</span></span>
<span class="line"><span style="color:#F97583">            let</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomPoint.x </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x</span></span>
<span class="line"><span style="color:#F97583">            let</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomPoint.y </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y</span></span>
<span class="line"><span style="color:#6A737D">            // 跟随距离改变上升速度,逐渐变慢</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.01</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.01</span></span>
<span class="line"><span style="color:#6A737D">            // 后期烟花移动速度过慢,故给一个距离范围,进入范围便爆炸</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dx) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomArea </span><span style="color:#F97583">&#x26;&#x26;</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dy) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.boomArea) {</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">initBoom</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">        draw</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">save</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">beginPath</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">arc</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.color</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">fill</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">restore</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">        drawTail</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">save</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "rgba(186,186,86,0.3)"</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">beginPath</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">arc</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> 4</span><span style="color:#E1E4E8">), </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">fill</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">restore</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">        initBoom</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">            let</span><span style="color:#E1E4E8"> num </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">200</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">            for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">let</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">; i </span><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8"> num; i</span><span style="color:#F97583">++</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">                let</span><span style="color:#E1E4E8"> tan </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">, Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">                let</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">250</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">cos</span><span style="color:#E1E4E8">(tan) </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x;</span></span>
<span class="line"><span style="color:#F97583">                let</span><span style="color:#E1E4E8"> y </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">250</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">sin</span><span style="color:#E1E4E8">(tan) </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y;</span></span>
<span class="line"><span style="color:#F97583">                let</span><span style="color:#E1E4E8"> boom </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> Spark</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">), </span><span style="color:#B392F0">randomColor</span><span style="color:#E1E4E8">(), x, y);</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.booms.</span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(boom);</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">        boomAction</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">            let</span><span style="color:#E1E4E8"> deadNum </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#F97583">            for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">let</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">; i </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.booms.</span><span style="color:#79B8FF">length</span><span style="color:#E1E4E8">; i</span><span style="color:#F97583">++</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">                if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.booms[i].dead) {</span></span>
<span class="line"><span style="color:#79B8FF">                    this</span><span style="color:#E1E4E8">.booms[i].</span><span style="color:#B392F0">update</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">                } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">                    deadNum</span><span style="color:#F97583">++</span></span>
<span class="line"><span style="color:#E1E4E8">                }</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (deadNum </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.booms.</span><span style="color:#79B8FF">length</span><span style="color:#E1E4E8">) </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.sparkDead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">        update</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.dead) {</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">move</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">draw</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">drawTail</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">boomAction</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    class</span><span style="color:#B392F0"> Spark</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        constructor</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">centerX</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">centerY</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">color</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">dieX</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">dieY</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.dieX </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dieX;</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dieY;</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerX;</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerY;</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.centerX </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerX;</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.centerY </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> centerY;</span></span>
<span class="line"><span style="color:#6A737D">            // 火花大小差异化</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">=</span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(radius, radius </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.color </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> color;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#B392F0">        draw</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">save</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">beginPath</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">arc</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y, </span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.radius, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> Math.</span><span style="color:#79B8FF">PI</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.color;</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">fill</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            ctx.</span><span style="color:#B392F0">restore</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#B392F0">        move</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#6A737D">            // 模拟重力下降</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.radius </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 10</span></span>
<span class="line"><span style="color:#F97583">            let</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieX </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.x</span></span>
<span class="line"><span style="color:#F97583">            let</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.y</span></span>
<span class="line"><span style="color:#6A737D">            // 如果距离小于 0.1 则坐标直接等于消失坐标</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dx) </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0.1</span><span style="color:#F97583"> ?</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieX </span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dx </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#79B8FF">            this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dy) </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0.1</span><span style="color:#F97583"> ?</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.dieY </span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.y </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> dy </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 0.1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#6A737D">            // x 达到消失坐标,则消失</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (dx </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> &#x26;&#x26;</span><span style="color:#E1E4E8"> Math.</span><span style="color:#B392F0">abs</span><span style="color:#E1E4E8">(dy) </span><span style="color:#F97583">&#x3C;=</span><span style="color:#79B8FF"> 80</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.dead </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#B392F0">        update</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.dead) {</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">move</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">                this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">draw</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> particles</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> oldTime </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> Date</span><span style="color:#E1E4E8">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#B392F0"> animation</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#E1E4E8">        window.</span><span style="color:#B392F0">requestAnimationFrame</span><span style="color:#E1E4E8">(animation);</span></span>
<span class="line"><span style="color:#6A737D">        // 使用 透明度0.1填充画布,实现烟花拖拽特效</span></span>
<span class="line"><span style="color:#E1E4E8">        ctx.fillStyle </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "rgba(0, 0, 0, 0.1)"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        ctx.</span><span style="color:#B392F0">fillRect</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, canvas.width, canvas.height);</span></span>
<span class="line"><span style="color:#6A737D">        // 间隔时间生成烟花</span></span>
<span class="line"><span style="color:#F97583">        let</span><span style="color:#E1E4E8"> newDate </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> Date</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (newDate </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> oldTime </span><span style="color:#F97583">></span><span style="color:#B392F0"> random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1500</span><span style="color:#E1E4E8">)) {</span></span>
<span class="line"><span style="color:#F97583">            let</span><span style="color:#E1E4E8"> o </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> FireWork</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">(_W </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0.8</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> _W), </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"#FFF"</span><span style="color:#E1E4E8">, {</span></span>
<span class="line"><span style="color:#E1E4E8">                x: </span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">(_W </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0.8</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> _W),</span></span>
<span class="line"><span style="color:#E1E4E8">                y: </span><span style="color:#B392F0">random</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">200</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            })</span></span>
<span class="line"><span style="color:#E1E4E8">            particles.</span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(o)</span></span>
<span class="line"><span style="color:#E1E4E8">            oldTime </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> newDate</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#6A737D">        // 遍历烟花和删除死亡烟花</span></span>
<span class="line"><span style="color:#E1E4E8">        particles.</span><span style="color:#B392F0">forEach</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">element</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">index</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">            element.</span><span style="color:#B392F0">update</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (element.sparkDead) {</span></span>
<span class="line"><span style="color:#E1E4E8">                particles.</span><span style="color:#B392F0">splice</span><span style="color:#E1E4E8">(index, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">        });</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    animation</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">html</span><span style="color:#E1E4E8">></span></span></code></pre>  <!-- 评论区域 --> <div id="waline" class="waline-container" data-astro-cid-6z674vj5></div> <script type="module" src="/_astro/WalineComment.astro_astro_type_script_index_0_lang.Dq86Uk2i.js"></script>  </div> <nav class="toc-sidebar" data-astro-cid-bvzihdzo> <h4 data-astro-cid-bvzihdzo>目录</h4> <ul data-astro-cid-bvzihdzo> <li class="toc-item toc-h1" data-astro-cid-bvzihdzo> <a href="#canvas-动画---烟花" data-astro-cid-bvzihdzo>「Canvas 动画 」- 烟花</a> </li><li class="toc-item toc-h2" data-astro-cid-bvzihdzo> <a href="#前言" data-astro-cid-bvzihdzo>前言</a> </li><li class="toc-item toc-h2" data-astro-cid-bvzihdzo> <a href="#基本框架" data-astro-cid-bvzihdzo>基本框架</a> </li><li class="toc-item toc-h2" data-astro-cid-bvzihdzo> <a href="#烟花飞行" data-astro-cid-bvzihdzo>烟花飞行</a> </li><li class="toc-item toc-h2" data-astro-cid-bvzihdzo> <a href="#火花飞行" data-astro-cid-bvzihdzo>火花飞行</a> </li><li class="toc-item toc-h2" data-astro-cid-bvzihdzo> <a href="#烟花爆炸" data-astro-cid-bvzihdzo>烟花爆炸</a> </li><li class="toc-item toc-h2" data-astro-cid-bvzihdzo> <a href="#最终代码" data-astro-cid-bvzihdzo>最终代码</a> </li> </ul> </nav> </div> </article> </main> <footer data-astro-cid-sz7xmlte>
logyxiao's Blog-&copy; 2025 - by Astro.
<div class="social-links" data-astro-cid-sz7xmlte></div> </footer>  <script>
if (typeof window !== 'undefined') {
	window.addEventListener('DOMContentLoaded', () => {
		const main = document.querySelector('.blog-content-main');
		if (!main) return;

		// 代码块复制按钮
		main.querySelectorAll('pre code').forEach(block => {
			const pre = block.parentElement;
			if (!pre) return;
			const btn = document.createElement('button');
			btn.className = 'copy-btn';
			btn.type = 'button';
			btn.innerText = '复制';
			btn.onclick = () => {
				navigator.clipboard.writeText(block.innerText);
				btn.innerText = '已复制!';
				setTimeout(() => { btn.innerText = '复制'; }, 1200);
			};
			pre.style.position = 'relative';
			btn.style.position = 'absolute';
			btn.style.top = '8px';
			btn.style.right = '12px';
			pre.appendChild(btn);
		});
	});
}
</script> </body></html>